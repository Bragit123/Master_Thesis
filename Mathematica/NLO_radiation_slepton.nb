(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29067,        784]
NotebookOptionsPosition[     25956,        731]
NotebookOutlinePosition[     26350,        747]
CellTagsIndexPosition[     26307,        744]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Slepton-side \[Gamma]-radiation", "Title",
 CellChangeTimes->{{3.965272352522628*^9, 3.96527237867*^9}, {
  3.965272434151207*^9, 
  3.9652724628006697`*^9}},ExpressionUUID->"0b9f0f09-4d69-4edc-ab0e-\
d95f4ff224a4"],

Cell[CellGroupData[{

Cell["Load FeynCalc", "Section",
 CellChangeTimes->{{3.9652724797168217`*^9, 
  3.965272511248272*^9}},ExpressionUUID->"ba2ad72c-a727-45eb-9573-\
09c033cfbf95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "description", "=", 
   "\"\<Photon radiation correction to slepton pair production.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$FrontEnd", "===", "Null"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"$FeynCalcStartupMessages", "=", "False"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "description", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$Notebooks", "===", "False"}], ",", "\[IndentingNewLine]", 
    RowBox[{"$FeynCalcStartupMessages", "=", "False"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$LoadAddOns", "=", 
   RowBox[{"{", "\"\<FeynArts\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "FeynCalc`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FAVerbose", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FCCheckVersion", "[", 
   RowBox[{"9", ",", "3", ",", "1"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.965272513798456*^9, 3.965272618909473*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"6d2b2172-8a32-4e44-9b2c-c57afc2645da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate the squared amplitude", "Section",
 CellChangeTimes->{{3.965272635615243*^9, 
  3.965272639767015*^9}},ExpressionUUID->"acac79aa-5ff7-4973-ab43-\
b6453645e784"],

Cell[CellGroupData[{

Cell["Draw diagrams", "Subsection",
 CellChangeTimes->{{3.96527264478922*^9, 
  3.965272662890481*^9}},ExpressionUUID->"0b7f4cc6-6b24-44b0-830a-\
e48e4385a40b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"diags", "=", 
   RowBox[{"InsertFields", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CreateTopologies", "[", 
      RowBox[{"0", ",", 
       RowBox[{"2", "->", "3"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F", "[", 
         RowBox[{"3", ",", 
          RowBox[{"{", "quarkGen", "}"}]}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"F", "[", 
          RowBox[{"3", ",", 
           RowBox[{"{", "quarkGen", "}"}]}], "]"}]}]}], "}"}], "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"S", "[", 
          RowBox[{"12", ",", 
           RowBox[{"{", 
            RowBox[{"B", ",", "i"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"V", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", 
         RowBox[{"12", ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", "i"}], "}"}]}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Model", "->", "MSSM"}], ",", "\[IndentingNewLine]", 
     RowBox[{"InsertionLevel", "->", 
      RowBox[{"{", "Classes", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ExcludeParticles", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "4", "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Paint", "[", "\[IndentingNewLine]", 
   RowBox[{"diags", ",", "\[IndentingNewLine]", 
    RowBox[{"ColumnsXRows", "->", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"SheetHeader", "->", "None"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Numbering", "->", "Simple"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "->", 
     RowBox[{"{", 
      RowBox[{"512", ",", "256"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.965272663732286*^9, 3.9652729831235228`*^9}, {
  3.965273029605319*^9, 3.965273048141762*^9}, {3.965273440039936*^9, 
  3.96527344144805*^9}, {3.965273572829671*^9, 3.9652735764069757`*^9}, {
  3.965273812025065*^9, 3.96527382976756*^9}, {3.965273990342332*^9, 
  3.965273990697516*^9}, {3.965274109467029*^9, 3.965274109777762*^9}, {
  3.9652741679594803`*^9, 3.96527417188796*^9}, {3.965274223263739*^9, 
  3.965274264118342*^9}, {3.965274295989792*^9, 3.965274296107067*^9}, {
  3.965274363437047*^9, 3.9652743935983047`*^9}, {3.965277298453209*^9, 
  3.965277306833355*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"87bece87-588a-4952-8cb6-9de53afc1ccf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeBoxes", "[", 
    RowBox[{"p1", ",", " ", "TraditionalForm"}], "]"}], " ", ":=", " ", 
   "\"\<\\!\\(\\*SubscriptBox[\\(p\\),\\(1\\)]\\)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeBoxes", "[", 
    RowBox[{"p2", ",", " ", "TraditionalForm"}], "]"}], " ", ":=", " ", 
   "\"\<\\!\\(\\*SubscriptBox[\\(p\\),\\(2\\)]\\)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{"p3", ",", " ", "TraditionalForm"}], "]"}], " ", ":=", " ", 
    "\"\<\\!\\(\\*SubscriptBox[\\(p\\),\\(3\\)]\\)\>\""}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeBoxes", "[", 
    RowBox[{"p4", ",", " ", "TraditionalForm"}], "]"}], " ", ":=", " ", 
   "\"\<\\!\\(\\*SubscriptBox[\\(p\\),\\(4\\)]\\)\>\""}], ";"}]}], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"c4ebc5a0-b37c-46f6-af74-e6f2dab34f0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "[", "0", "]"}], "=", 
  RowBox[{
   RowBox[{"FCFAConvert", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CreateFeynAmp", "[", "diags", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"IncomingMomenta", "->", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"OutgoingMomenta", "->", 
      RowBox[{"{", 
       RowBox[{"p3", ",", "k", ",", "p4"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ChangeDimension", "->", "4"}], ",", "\[IndentingNewLine]", 
     RowBox[{"UndoChiralSplittings", "->", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"List", "->", "False"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Contract", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"DropSumOver", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"SMP", "->", "True"}]}], "\[IndentingNewLine]", "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"MQU", "[", "quarkGen", "]"}], "->", "0"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.965273636102611*^9, 3.96527373814944*^9}, {
  3.96527729226095*^9, 3.965277311200943*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"7f912381-747f-4d84-8dc6-9fe5cda19be8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract the fifth diagram, and change 2/3 to e_Q", "Subsection",
 CellChangeTimes->{{3.965450673300849*^9, 3.9654506828244457`*^9}, {
  3.965450727483266*^9, 
  3.96545074189809*^9}},ExpressionUUID->"32edcb37-881b-47c0-affb-\
0cfbddd4e206"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pair", "[", 
    RowBox[{
     RowBox[{"Momentum", "[", "k", "]"}], ",", 
     RowBox[{"Momentum", "[", 
      RowBox[{"Polarization", "[", 
       RowBox[{"k", ",", 
        RowBox[{"-", "I"}]}], "]"}], "]"}]}], "]"}], "=", "0"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{"Lorenz", " ", "gauge"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"M5", "[", "0", "]"}], "=", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"M", "[", "0", "]"}], ",", "5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M5", "[", "1", "]"}], "=", 
  RowBox[{
   RowBox[{"M5", "[", "0", "]"}], " ", 
   RowBox[{"3", "/", "2"}], " ", 
   RowBox[{"SMP", "[", "\"\<e_Q\>\"", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.965450622175632*^9, 3.965450630019004*^9}, {
   3.9654573089684553`*^9, 3.965457315396605*^9}, {3.965467484341366*^9, 
   3.9654675307249107`*^9}, {3.965467653469789*^9, 3.9654676554684763`*^9}, {
   3.9654677861117983`*^9, 3.965467786514214*^9}, {3.965467999100952*^9, 
   3.965468019905507*^9}, {3.965535895353269*^9, 3.9655358984751472`*^9}, 
   3.965705306497377*^9, {3.96570564212451*^9, 3.965705662065524*^9}, {
   3.965705952536393*^9, 3.965705970634055*^9}, {3.9657061177694273`*^9, 
   3.965706121087577*^9}, 3.965706152135209*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"19ee6efc-ad23-4687-9f3c-fa482ff451e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M5", "[", "1", "]"}], "//", "DiracSimplify"}]], "Input",
 CellChangeTimes->{{3.9654573257730513`*^9, 3.965457332656719*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"c2f52b08-1c9b-4bae-85b9-18c76a1a7f08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M5CC", "[", "1", "]"}], "=", 
  RowBox[{"ComplexConjugate", "[", 
   RowBox[{"M5", "[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.965450772420856*^9, 3.965450786205844*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"e759f14d-414e-4c62-875c-ec2e91b91237"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FCClearScalarProducts", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SP", "[", "p1", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"SP", "[", "p2", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"SP", "[", "k", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "SetMandelstam", "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "How", " ", "do", " ", "I", " ", "do", " ", "this", " ", "for", " ", "a", 
     " ", "2"}], "->", 
    RowBox[{"3", " ", 
     RowBox[{"process", "?"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.96545079770851*^9, 3.965450877449489*^9}, {
  3.965467469346641*^9, 3.965467472232254*^9}, {3.965705679257079*^9, 
  3.965705679487598*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"254168a2-2f8f-4707-a543-aec87dae683b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M5Squared", "[", "0", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"M5", "[", "1", "]"}], " ", 
       RowBox[{"M5CC", "[", "1", "]"}]}], ")"}], "//", 
     "FeynAmpDenominatorExplicit"}], "//", 
    RowBox[{
     RowBox[{"FermionSpinSum", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ExtraFactor", "->", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"4", " ", 
           RowBox[{"SUNN", "^", "2"}]}], ")"}]}]}]}], "]"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"DoPolarizationSums", "[", 
     RowBox[{"#", ",", "k", ",", "0"}], "]"}], "&"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"//", "DiracSimplify"}], "//", 
      RowBox[{
       RowBox[{"SUNSimplify", "[", 
        RowBox[{"#", ",", 
         RowBox[{"SUNNToCACF", "->", "False"}]}], "]"}], "&"}]}], "//", 
     "Simplify"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.965450882413868*^9, 3.965450962530313*^9}, {
   3.9654681014451714`*^9, 3.9654681727083693`*^9}, {3.965705625552598*^9, 
   3.9657056306903667`*^9}, {3.9657056762559443`*^9, 3.965705677247161*^9}, 
   3.965711611989354*^9, {3.965711727795301*^9, 3.965711732210855*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"e93d5ef6-bbec-4521-a699-9c36ebcb5821"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SP", "[", "p3", "]"}], "=", 
   RowBox[{
    RowBox[{"MSf", "[", 
     RowBox[{"B", ",", "2", ",", "i"}], "]"}], "^", "2"}]}], ";", " ", 
  RowBox[{
   RowBox[{"SP", "[", "p4", "]"}], "=", 
   RowBox[{
    RowBox[{"MSf", "[", 
     RowBox[{"A", ",", "2", ",", "i"}], "]"}], "^", "2"}]}], ";", " ", 
  RowBox[{
   RowBox[{"MSf", "[", 
    RowBox[{"B", ",", "2", ",", "i"}], "]"}], "=", 
   RowBox[{"MSf", "[", 
    RowBox[{"A", ",", "2", ",", "i"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.96570678475008*^9, 3.965706824330147*^9}, {
  3.965707395103804*^9, 3.965707412270116*^9}, {3.965708466863543*^9, 
  3.965708470415719*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"01a1c755-9945-4332-aae9-533476361535"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M5Squared", "[", "1", "]"}], "=", 
  RowBox[{
   RowBox[{"M5Squared", "[", "0", "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.9657073294848633`*^9, 3.965707334840282*^9}, {
  3.965707382569666*^9, 3.9657073836412477`*^9}, {3.965708516035131*^9, 
  3.965708518217289*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"e2435be9-7dd4-401d-8e65-eeacf4f7ef1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mandelstam23Rules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Pair", "[", 
       RowBox[{
        RowBox[{"Momentum", "[", "p1", "]"}], ",", 
        RowBox[{"Momentum", "[", "p2", "]"}]}], "]"}], "->", 
      RowBox[{"s12", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pair", "[", 
       RowBox[{
        RowBox[{"Momentum", "[", "p1", "]"}], ",", 
        RowBox[{"Momentum", "[", "p3", "]"}]}], "]"}], "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MSf", "[", 
           RowBox[{"A", ",", "2", ",", "i"}], "]"}], "^", "2"}], "-", "t13"}],
         ")"}], "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pair", "[", 
       RowBox[{
        RowBox[{"Momentum", "[", "p1", "]"}], ",", 
        RowBox[{"Momentum", "[", "p4", "]"}]}], "]"}], "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MSf", "[", 
           RowBox[{"A", ",", "2", ",", "i"}], "]"}], "^", "2"}], "-", "t14"}],
         ")"}], "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pair", "[", 
       RowBox[{
        RowBox[{"Momentum", "[", "p2", "]"}], ",", 
        RowBox[{"Momentum", "[", "p3", "]"}]}], "]"}], "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MSf", "[", 
           RowBox[{"A", ",", "2", ",", "i"}], "]"}], "^", "2"}], "-", "t23"}],
         ")"}], "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pair", "[", 
       RowBox[{
        RowBox[{"Momentum", "[", "p2", "]"}], ",", 
        RowBox[{"Momentum", "[", "p4", "]"}]}], "]"}], "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MSf", "[", 
           RowBox[{"A", ",", "2", ",", "i"}], "]"}], "^", "2"}], "-", "t24"}],
         ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9657107090824223`*^9, 3.9657109069168653`*^9}, {
  3.965710966324704*^9, 3.965710999870556*^9}, {3.965711032532037*^9, 
  3.965711075197949*^9}, {3.965711235323992*^9, 3.96571128827507*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"67ba9bd4-1a1c-4140-a886-b9294dd205c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M5Squared", "[", "2", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"M5Squared", "[", "1", "]"}], "//.", "Mandelstam23Rules"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.965710908406887*^9, 3.9657109374543037`*^9}, {
  3.965711004537434*^9, 3.965711023793681*^9}, {3.965711295276739*^9, 
  3.965711304875081*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"0b67327f-22a0-4603-9a9d-f132287974cb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extract all diagrams radiating from A-slepton", "Subsection",
 CellChangeTimes->{{3.965720220583769*^9, 
  3.96572024027562*^9}},ExpressionUUID->"1632987e-4242-4de2-ba40-\
219efd184753"],

Cell[TextData[{
 "Change ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox["2", "3"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{2}{3}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "69010466-640a-4b43-b172-50cb14930d7f"],
 " to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["e", "TI"], 
        StyleBox["Q", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "e_Q", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "932e2630-a8c1-4744-8f09-748a78c84f6a"],
 "for quark charge in photon diagram."
}], "Text",
 CellChangeTimes->{
  3.965731736851407*^9},ExpressionUUID->"c5498313-a688-4cee-b3ea-\
d6ff9ec7abbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M5", "[", "0", "]"}], "=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"M", "[", "0", "]"}], ",", "5"}], "]"}], " ", 
   RowBox[{"3", "/", "2"}], " ", 
   RowBox[{"SMP", "[", "\"\<e_Q\>\"", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M6", "[", "0", "]"}], "=", 
  RowBox[{"Part", "[", 
   RowBox[{
    RowBox[{"M", "[", "0", "]"}], ",", "6"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.965723772030999*^9, 3.965723819081181*^9}, {
   3.965723929945063*^9, 3.96572395830306*^9}, 3.9657244584357*^9, 
   3.9657317425785303`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"6e50df8d-1e45-4c5b-b391-7dd8f98530dd"],

Cell[TextData[{
 "Rewrite the \[OpenCurlyDoubleQuote]chiral coefficients\
\[CloseCurlyDoubleQuote] into ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Z", "TI"], 
        SubscriptBox[
         StyleBox["q", "TI"], 
         StyleBox["L", "TI"]]], TraditionalForm], "errors" -> {}, "input" -> 
     "Z_{q_L}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6139306f-09ce-4701-89fe-009c56e238ff"],
 "and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["Z", "TI"], 
        SubscriptBox[
         StyleBox["q", "TI"], 
         StyleBox["R", "TI"]]], TraditionalForm], "errors" -> {}, "input" -> 
     "Z_{q_R}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1959aeaf-2bec-4129-afbe-d7164e2ee06a"],
 " (see p.164 in Richardson). Note that the amplitudes in FeynArts used up \
quarks."
}], "Text",
 CellChangeTimes->{
  3.965731726676581*^9},ExpressionUUID->"c35cb56a-1bb9-42b8-943f-\
8f55377eec4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"M6", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"M6", "[", "0", "]"}], "/.", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{
          RowBox[{"SMP", "[", "\"\<sin_W\>\"", "]"}], "^", "2"}]}], "-", 
        "3"}], ":>", 
       RowBox[{"12", " ", "Zql"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SMP", "[", "\"\<sin_W\>\"", "]"}], "/", 
        RowBox[{"SMP", "[", "\"\<cos_W\>\"", "]"}]}], ":>", 
       RowBox[{"3", 
        RowBox[{"Zqr", " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"SMP", "[", "\"\<sin_W\>\"", "]"}], " ", 
           RowBox[{"SMP", "[", "\"\<cos_W\>\"", "]"}]}], ")"}]}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.965731122046685*^9, 3.965731220927435*^9}, {
  3.965731349307219*^9, 3.965731603393935*^9}, {3.965731715962973*^9, 
  3.965731717240549*^9}, {3.965731755645846*^9, 3.9657317559591503`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"c0bfe9b4-1089-4de7-bdba-63cfaaf1abce"],

Cell[TextData[{
 "Rewrite the sfermion mixing matrices USf into ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubsuperscriptBox[
        StyleBox["Z", "TI"], 
        SubscriptBox[
         StyleBox["l", "TI"], 
         StyleBox["i", "TI"]], 
        RowBox[{
          StyleBox["A", "TI"], 
          StyleBox["B", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "Z_{l_i}^{AB}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0a351837-a4b1-4150-a459-8e7d192f9455"],
 "(again: see p.164 in Richardson), using that the mixing matrices are real, \
and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{
            StyleBox["A", "TI"], "1"}]], 
         SubsuperscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{
            StyleBox["B", "TI"], "1"}], "*"], "+", 
         SubscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{
            StyleBox["A", "TI"], "2"}]], 
         SubsuperscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{
            StyleBox["B", "TI"], "2"}], "*"], "\[LongEqual]", 
         SubscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{
            StyleBox["A", "TI"], "1"}]], 
         SubsuperscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{"1", 
            StyleBox["B", "TI"]}], 
          StyleBox["T", "TI"]], "+", 
         SubscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{
            StyleBox["A", "TI"], "2"}]], 
         SubsuperscriptBox[
          StyleBox["L", "TI"], 
          RowBox[{"2", 
            StyleBox["B", "TI"]}], 
          StyleBox["T", "TI"]], "\[LongEqual]", 
         SubscriptBox[
          RowBox[{"(", 
            RowBox[{
              StyleBox["L", "TI"], 
              SuperscriptBox[
               StyleBox["L", "TI"], 
               StyleBox["T", "TI"]]}], ")"}], 
          RowBox[{
            StyleBox["A", "TI"], 
            StyleBox["B", "TI"]}]], "\[LongEqual]", 
         SubscriptBox["\[Delta]", 
          RowBox[{
            StyleBox["A", "TI"], 
            StyleBox["B", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "L_{A1}L_{B1}^*+L_{A2}L_{B2}^*=L_{A1}L_{1B}^T+L_{A2}L_{2B}^T=(LL^T)_{AB}=\
\\delta_{AB}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "118826bc-9bf1-4515-bf75-c840b360431e"],
 "."
}], "Text",
 CellChangeTimes->{{3.965731759694434*^9, 
  3.965731766642153*^9}},ExpressionUUID->"641f43dc-a0fe-4ed9-999a-\
3a51a5ab8a3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"M6", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"M6", "[", "1", "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"USf", "[", 
          RowBox[{"2", ",", "i"}], "]"}], "[", 
         RowBox[{"A", ",", "2"}], "]"}], " ", 
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"USf", "[", 
           RowBox[{"2", ",", "i"}], "]"}], "[", 
          RowBox[{"B", ",", "2"}], "]"}], "]"}]}], ":>", 
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"A", ",", "B"}], "]"}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"USf", "[", 
           RowBox[{"2", ",", "i"}], "]"}], "[", 
          RowBox[{"A", ",", "1"}], "]"}], " ", 
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"USf", "[", 
            RowBox[{"2", ",", "i"}], "]"}], "[", 
           RowBox[{"B", ",", "1"}], "]"}], "]"}]}]}]}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M6", "[", "3", "]"}], "=", 
  RowBox[{
   RowBox[{"M6", "[", "2", "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{
        RowBox[{"SMP", "[", "\"\<sin_W\>\"", "]"}], "^", "2"}], " ", 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"A", ",", "B"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"USf", "[", 
         RowBox[{"2", ",", "i"}], "]"}], "[", 
        RowBox[{"A", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{
         RowBox[{"USf", "[", 
          RowBox[{"2", ",", "i"}], "]"}], "[", 
         RowBox[{"B", ",", "1"}], "]"}], "]"}]}]}], "->", 
     RowBox[{
      RowBox[{"-", "2"}], "ZliAB"}]}], "}"}]}]}]}], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"da102f94-7922-4dd5-8607-77318e6251eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M56", "[", "0", "]"}], "=", 
  RowBox[{
   RowBox[{"M5", "[", "0", "]"}], "+", 
   RowBox[{"M6", "[", "3", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.96573181669683*^9, 3.965731830249291*^9}, {
  3.965731917745943*^9, 3.965731918133684*^9}, {3.965731957603887*^9, 
  3.965731958629322*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"140d5894-8bb3-4c76-b4f3-7bc7932de3bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M56CC", "[", "0", "]"}], "=", 
  RowBox[{"ComplexConjugate", "[", 
   RowBox[{"M56", "[", "0", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.965731934171851*^9, 3.965731968596689*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"a1d28395-85f7-4d0e-9d13-28b21fc2937c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FCClearScalarProducts", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SP", "[", "p1", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"SP", "[", "p2", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"SP", "[", "k", "]"}], "=", "\[Epsilon]"}], ";", 
  RowBox[{
   RowBox[{"SP", "[", "p3", "]"}], "=", 
   RowBox[{"MSf", "[", 
    RowBox[{"B", ",", "2", ",", "i"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"SP", "[", "p4", "]"}], "=", 
   RowBox[{"MSf", "[", 
    RowBox[{"A", ",", "2", ",", "i"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.965731978607478*^9, 3.9657320410264072`*^9}, {
  3.965732871036128*^9, 3.965732873971035*^9}, {3.96573292811817*^9, 
  3.965732942742285*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"d772f0d8-75a3-44ce-aae0-53706468ba05"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{724, 791},
WindowMargins->{{8, Automatic}, {Automatic, 8}},
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ce7c4f7c-7861-4c44-bd70-9220ce48b789"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 221, 4, 98, "Title",ExpressionUUID->"0b9f0f09-4d69-4edc-ab0e-d95f4ff224a4"],
Cell[CellGroupData[{
Cell[826, 30, 160, 3, 67, "Section",ExpressionUUID->"ba2ad72c-a727-45eb-9573-09c033cfbf95"],
Cell[989, 35, 1246, 31, 262, "Input",ExpressionUUID->"6d2b2172-8a32-4e44-9b2c-c57afc2645da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2272, 71, 176, 3, 67, "Section",ExpressionUUID->"acac79aa-5ff7-4973-ab43-b6453645e784"],
Cell[CellGroupData[{
Cell[2473, 78, 160, 3, 54, "Subsection",ExpressionUUID->"0b7f4cc6-6b24-44b0-830a-e48e4385a40b"],
Cell[2636, 83, 2689, 63, 325, "Input",ExpressionUUID->"87bece87-588a-4952-8cb6-9de53afc1ccf"],
Cell[5328, 148, 963, 25, 94, "Input",ExpressionUUID->"c4ebc5a0-b37c-46f6-af74-e6f2dab34f0f"],
Cell[6294, 175, 1245, 26, 241, "Input",ExpressionUUID->"7f912381-747f-4d84-8dc6-9fe5cda19be8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7576, 206, 246, 4, 54, "Subsection",ExpressionUUID->"32edcb37-881b-47c0-affb-0cfbddd4e206"],
Cell[7825, 212, 1391, 32, 73, "Input",ExpressionUUID->"19ee6efc-ad23-4687-9f3c-fa482ff451e8"],
Cell[9219, 246, 238, 4, 30, "Input",ExpressionUUID->"c2f52b08-1c9b-4bae-85b9-18c76a1a7f08"],
Cell[9460, 252, 298, 6, 30, "Input",ExpressionUUID->"e759f14d-414e-4c62-875c-ec2e91b91237"],
Cell[9761, 260, 851, 22, 73, "Input",ExpressionUUID->"254168a2-2f8f-4707-a543-aec87dae683b"],
Cell[10615, 284, 1312, 35, 115, "Input",ExpressionUUID->"e93d5ef6-bbec-4521-a699-9c36ebcb5821"],
Cell[11930, 321, 763, 20, 30, "Input",ExpressionUUID->"01a1c755-9945-4332-aae9-533476361535"],
Cell[12696, 343, 400, 8, 30, "Input",ExpressionUUID->"e2435be9-7dd4-401d-8e65-eeacf4f7ef1c"],
Cell[13099, 353, 2314, 63, 157, "Input",ExpressionUUID->"67ba9bd4-1a1c-4140-a886-b9294dd205c2"],
Cell[15416, 418, 445, 10, 30, "Input",ExpressionUUID->"0b67327f-22a0-4603-9a9d-f132287974cb"]
}, Closed]],
Cell[CellGroupData[{
Cell[15898, 433, 192, 3, 38, "Subsection",ExpressionUUID->"1632987e-4242-4de2-ba40-219efd184753"],
Cell[16093, 438, 809, 23, 53, "Text",ExpressionUUID->"c5498313-a688-4cee-b3ea-d6ff9ec7abbe"],
Cell[16905, 463, 672, 17, 52, "Input",ExpressionUUID->"6e50df8d-1e45-4c5b-b391-7dd8f98530dd"],
Cell[17580, 482, 1095, 31, 61, "Text",ExpressionUUID->"c35cb56a-1bb9-42b8-943f-8f55377eec4c"],
Cell[18678, 515, 1154, 29, 94, "Input",ExpressionUUID->"c0bfe9b4-1089-4de7-bdba-63cfaaf1abce"],
Cell[19835, 546, 2647, 79, 64, "Text",ExpressionUUID->"641f43dc-a0fe-4ed9-999a-3a51a5ab8a3a"],
Cell[22485, 627, 1890, 57, 178, "Input",ExpressionUUID->"da102f94-7922-4dd5-8607-77318e6251eb"],
Cell[24378, 686, 404, 9, 30, "Input",ExpressionUUID->"140d5894-8bb3-4c76-b4f3-7bc7932de3bc"],
Cell[24785, 697, 300, 6, 30, "Input",ExpressionUUID->"a1d28395-85f7-4d0e-9d13-28b21fc2937c"],
Cell[25088, 705, 828, 21, 136, "Input",ExpressionUUID->"d772f0d8-75a3-44ce-aae0-53706468ba05"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

